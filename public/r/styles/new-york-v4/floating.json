{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "floating",
  "type": "registry:ui",
  "title": "Floating",
  "description": "Floating component",
  "dependencies": [],
  "registryDependencies": [],
  "files": [
    {
      "path": "registry/new-york-v4/ui/floating.tsx",
      "type": "registry:ui",
      "target": "components/ui/floating.tsx",
      "content": "\"use client\"\r\n\r\nimport { createContext, type ReactNode, useCallback, useContext, useEffect, useRef } from \"react\"\r\nimport { useAnimationFrame } from \"@/hooks/use-animation-frame\"\r\n\r\nimport { cn } from \"@/lib/utils\"\r\nimport { useMousePositionRef } from \"@/hooks/use-mouse-position-ref\"\r\n\r\ninterface FloatingContextType {\r\n  registerElement: (id: string, element: HTMLDivElement, depth: number) => void\r\n  unregisterElement: (id: string) => void\r\n}\r\n\r\nconst FloatingContext = createContext<FloatingContextType | null>(null)\r\n\r\ninterface FloatingProps {\r\n  children: ReactNode\r\n  className?: string\r\n  sensitivity?: number\r\n  easingFactor?: number\r\n}\r\n\r\nconst Floating = ({\r\n  children,\r\n  className,\r\n  sensitivity = 1,\r\n  easingFactor = 0.05,\r\n  ...props\r\n}: FloatingProps) => {\r\n  const containerRef = useRef<HTMLDivElement>(null)\r\n  const elementsMap = useRef(\r\n    new Map<\r\n      string,\r\n      {\r\n        element: HTMLDivElement\r\n        depth: number\r\n        currentPosition: { x: number; y: number }\r\n      }\r\n    >()\r\n  )\r\n  const mousePositionRef = useMousePositionRef(containerRef)\r\n\r\n  const registerElement = useCallback((id: string, element: HTMLDivElement, depth: number) => {\r\n    elementsMap.current.set(id, {\r\n      element,\r\n      depth,\r\n      currentPosition: { x: 0, y: 0 },\r\n    })\r\n  }, [])\r\n\r\n  const unregisterElement = useCallback((id: string) => {\r\n    elementsMap.current.delete(id)\r\n  }, [])\r\n\r\n  const scrollYRef = useRef(0)\r\n\r\n  useEffect(() => {\r\n    const handleScroll = () => {\r\n      scrollYRef.current = window.scrollY\r\n    }\r\n    window.addEventListener(\"scroll\", handleScroll, { passive: true })\r\n    return () => window.removeEventListener(\"scroll\", handleScroll)\r\n  }, [])\r\n\r\n  useAnimationFrame(() => {\r\n    if (!containerRef.current) return\r\n\r\n    elementsMap.current.forEach((data) => {\r\n      const mouseStrength = (data.depth * sensitivity) / 20\r\n      const scrollStrength = data.depth * 0.15 // Scroll parallax factor\r\n\r\n      const newTargetX = mousePositionRef.current.x * mouseStrength\r\n      const newTargetY =\r\n        mousePositionRef.current.y * mouseStrength - scrollYRef.current * scrollStrength\r\n\r\n      const dx = newTargetX - data.currentPosition.x\r\n      const dy = newTargetY - data.currentPosition.y\r\n\r\n      data.currentPosition.x += dx * easingFactor\r\n      data.currentPosition.y += dy * easingFactor\r\n\r\n      data.element.style.transform = `translate3d(${data.currentPosition.x}px, ${data.currentPosition.y}px, 0)`\r\n    })\r\n  })\r\n\r\n  return (\r\n    <FloatingContext.Provider value={{ registerElement, unregisterElement }}>\r\n      <div\r\n        ref={containerRef}\r\n        className={cn(\"absolute top-0 left-0 h-full w-full\", className)}\r\n        {...props}\r\n      >\r\n        {children}\r\n      </div>\r\n    </FloatingContext.Provider>\r\n  )\r\n}\r\n\r\nexport default Floating\r\n\r\ninterface FloatingElementProps {\r\n  children: ReactNode\r\n  className?: string\r\n  depth?: number\r\n}\r\n\r\nexport const FloatingElement = ({ children, className, depth = 1 }: FloatingElementProps) => {\r\n  const elementRef = useRef<HTMLDivElement>(null)\r\n  const idRef = useRef(Math.random().toString(36).substring(7))\r\n  const context = useContext(FloatingContext)\r\n\r\n  useEffect(() => {\r\n    if (!elementRef.current || !context) return\r\n\r\n    const nonNullDepth = depth ?? 0.01\r\n\r\n    context.registerElement(idRef.current, elementRef.current, nonNullDepth)\r\n    return () => context.unregisterElement(idRef.current)\r\n  }, [depth, context])\r\n\r\n  return (\r\n    <div ref={elementRef} className={cn(\"absolute will-change-transform\", className)}>\r\n      {children}\r\n    </div>\r\n  )\r\n}\r\n"
    }
  ]
}